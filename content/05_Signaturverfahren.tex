% vim: set tw=160:

\chapter{Anwendbare Signaturverfahren}
\index{Signaturverfahren}
\label{chap:Signaturverfahren}

\section{Überblick}
Wie in \fref{sec:GrundlagenDefinitionen:DigitaleSignaturen:Verfahren} bereits vorgestellt, bieten sich \gls{openpgp} und \gls{x509} für den Einsatz in
\gls{xml-dsig} an. Um solche Signaturen in \gls{xhtml} für den Besucher einer \gls{website} nutzbar zu machen müssen die dafür nötigen Komponenten in einem
\gls{webbrowser} vorhanden sein, oder über eine Erweiterung nachrüstbar sein. Dazu wird der \gls{webbrowser}
\index{Firefox}Firefox\footnote{\url{http://www.mozilla.com/firefox/}} wegen seiner umfangreichen Möglichkeiten zur Erweiterung mittels sogenannter
\glspl{firefox-addon} auf die Integration von \gls{openpgp} und \gls{x509} untersucht. Auch die zunehmende Verbreitung von \gls{firefox} im europäischen Raum
von über $50\%$ \cite{firefox-verbreitung} positioniert diesen \gls{webbrowser} als bevorzugtes Ziel für eine solche Erweiterung.

\section{OpenPGP}
\index{OpenPGP}
\label{sec:Signaturverfahren:OpenPGP}
Da \gls{openpgp} seine Verbreitung hauptsächlich im E-Mail-Verkehr und zur kryptografischen Absicherung von Code und Programmen erfährt, existiert in
\gls{firefox} so wie auch den, mit Stand Januar 2011, gängigen \gls{webbrowser}\footnote{\url{http://www.w3schools.com/browsers/browsers_stats.asp}} keine direkte
Schnittstelle zu einer \gls{openpgp}-Implementierung.

\subsection{Verbreitung}
\gls{firefox} bietet in seinem Auslieferungszustand keine Unterstützung für \gls{openpgp}. Mit Stand Januar 2011 existieren jedoch zwei \glspl{firefox-addon},
\index{Firefox!FireGPG}FireGPG\footnote{\url{http://getfiregpg.org/s/home}} und
\index{Firefox!Monkeysphere}Monkeysphere\footnote{\url{http://web.monkeysphere.info/}}, welche \gls{gpg}, eine \gls{foss}-Implementierung von \gls{openpgp},
nutzen, um digitale Signaturen in \gls{firefox} zu verwenden.

FireGPG bietet eine einfache Erkennung und Prüfung von \gls{openpgp}-Signaturen die als normaler Text im \gls{ascii} Armor Format \cite{openpgp:ietf} in
\glspl{webseite} eingebettet sind. Diese Textstellen werden dann in der Darstellung im Browser farblich hervorgehoben und Informationen zur Gültigkeit der
Signatur werden, beim Überfahren des Textes mit der Maus, angezeigt.

Monkeysphere dehnt, als \gls{firefox-addon}, das in \fref{sec:GrundlagenDefinitionen:Vertrauen:WOT} beschreibene \gls{wot} auf die \gls{pki}-Infrastruktur von
\gls{https} aus. Dabei bietet es sich als Option zur Validierung der gültigkeit von Schlüsseln an, wenn keine \gls{cot} bis zu einem in \gls{firefox}
hinterlegten Root-CA-Zertifikat für eine \gls{https}-Verbindung gefunden werden kann. Der Betreiber einer, über \gls{https} erreichbaren \gls{website}, kann
dafür den \gls{rsa}-Schlüssel seines \gls{x509}-Zertifikats in ein \gls{openpgp}-Zertifikat importieren. Für die ID dieses \gls{openpgp}-Zertifikats wird der
\gls{uri} des \gls{https}-Webservers verwendet. Das Zertifikat wird wird dann auf einen öffentlichen \gls{openpgp}-Schlüssel-Server geladen und kann dann später
automatisch vom Monkeysphere-AddOn gefunden werden, wenn keine gültige \gls{cot} von \gls{firefox} gefunden wird. Für das veröffentlichte
\gls{openpgp}-Zertifikat können die Benutzer dann dem \gls{wot} entsprechend ihr Vertrauen festlegen, welches dann von Monkeysphere auch innerhalb von
\gls{firefox} angezeigt wird.

Zur Verteilung der Schlüssel steht eine Infrastruktur aus öffentlichen Schlüsselservern zu Verfügung, über die das Auffinden von
\gls{openpgp}-Zertifikaten ermöglicht wird \cite{pgp}.

\subsection{Anwendung}
FireGPG und Monkeysphere benutzen beide eine, am System des Benutzers installierte, Instanz von \gls{gpg} und rufen das darin enthaltene, ausführbare Programm
\texttt{gpg} mit Parametern auf. Es wird keine Programm-Bibliothek zur Verarbeitung von \gls{openpgp}-Funktionen direkt in \gls{firefox} geladen. Dies ist dadurch
begründet, dass das Programm \texttt{gpg} seine Speicherbereiche, die auch sensitive Informationen wie Passwörter und private Schlüssel enthalten, besonders
gegen externe Zugriffe schützt \cite{pgp}. Alle Informationen, die der Browser für seine \gls{openpgp}-Funktionalität benötigt, laufen somit über Aufrufe von
\texttt{gpg}.

Für ein eigenes \gls{firefox-addon} für \gls{xml-dsig} wäre somit eine Anlehnung an diese Anbindung von \gls{gpg} von Vorteil da sie bereits in zwei Projekten
erprobt wurde und es auch den Intentionen der \gls{gpg}-Entwicklern entspricht \cite{pgp}.

\section{\protect\glstext*{x509}}
%\index{\protect\glstext*{x509}}
\label{sec:Signaturverfahren:x509}
Die Unterstützung für die kryptografisch abgesicherte Netzwerkverbindungen mittels \gls{https} ist in jedem \gls{webbrowser} integriert. Dazu gehört auch die
Unterstützung für das Verarbeiten von \gls{x509}-Zertifikaten. Abhängig vom \gls{webbrowser} werden die Zertifikate der Root-\glspl{ca} intern oder vom
Betriebssystem verwaltet.


\subsection{Verbreitung}
Für \gls{firefox} existiert das AddOn Key Manager Tool das \gls{x509}-Informationen außerhalb des Kontexts von \gls{https} verwendet. Es bietet Funktionen zur
Erstellung, Signierung und Verwaltung von \gls{x509}-Zertifikaten, ähnlich der Arbeitsweise einer \gls{ca}. 

\subsection{Anwendung}
Das \gls{firefox-addon} Key  Manager Tool verwendet die in \gls{firefox} integrierten Programmierschnittstellen für \gls{x509} die unter dem Namen \gls{psm}
und \gls{nss} verfügbar sind \cite{key-manager-tool}.

\section{Evaluierung}
Die Verwendung eines \gls{wot} zur Verteilung der Schlüssel-Informationen und der Vertrauensbeziehungen zwischen ihnen hätte gegenüber einer \gls{pki} mit
\gls{x509} den Vorteil, dass die Erstellung und Veröffentlichung eines \gls{openpgp}-Zertifikats einfach und ohne die Inanspruchnahme einer \gls{ca}
durchgeführt werden kann. Dies könnte die Akzeptanz in einer heterogenen Benutzergruppe steigern, da bei \gls{x509} in der Regel Gebühren von den \glspl{ca}
eingehoben werden und auch individuelle Vertrauensstellungen nicht möglich sind. Gegen den Einsatz eines \gls{wot} spricht die geringe Akzeptanz eines solchen
Ansatzes im betrieblichen Umfeld, was auf das Fehlen einer zentralen Authorrität zurückzuführen ist \cite{krypto-pki-internet}.

Beobachtungen der im Internet eingesetzten \gls{x509}-Zertifikate für \gls{https} haben gezeigt, dass auch Ansatz der zentralen Authoritäten wie \glspl{ca}
nicht vor Fehlern und unsachgemäßen Daten in den Zertifikaten schützt. Von 33916 Zertifikaten, die nach den strikt formulierten \gls{x509-ev}-Richtlinen
\cite{ev-ssl} signiert wurden, wiesen 38 Mängel auf, wie zum Beispiel schwache Schlüssel, \gls{ip}-Adressen aus dem Bereich von RFC-1918 oder "`localhost"' als
Wert für den \gls{dns}-Hostnamen des \gls{https}-Webservers \cite{ssliverse:27c3}.

\begin{table}
    \centering
    \begin{tabularx}{\textwidth}{ l X X }
        Anforderung  & \gls{openpgp} & \gls{x509} \\
        \hline
        \hline
        Programmierschnittstelle in \gls{firefox} & \Square & \CheckedBox \\
        \hline
        Dezentrale Verwaltung der Schlüssel& \CheckedBox & \Square \\
        \hline
    \end{tabularx}
    \caption{Gegenüberstellung der Signaturverfahren}
    \label{tab:gegenüberstellung}
\end{table}

\section{Auswahl eines Verfahrens}

